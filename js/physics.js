let dingusdingsudigsudignsugdweoinweiofnweiofewfniooi = " ";

do {
  dingusdingsudigsudignsugdweoinweiofnweiofewfniooi = prompt("Please enter password");
} 	
while (dingusdingsudigsudignsugdweoinweiofnweiofewfniooi != "htta ofr rlaaeeshr no vltlyauir ahd i yarbr sgyu up it praw bdyvoreye ten keat htigr lal geinrs mnbure ipudrnocto a rngdui cieisond elif ajmor a nigkma ont mi rbaybrayrr ho nisegr eehr sotp ew nca eenvyoer ryors mi srroy im  ti odlh snoecd a orf ospt usjt ltes it lohd sginer reov iagktnl arrby em  eeb iginnthk   ndrefi my ebe knihignt tsrat ot gto heav ouy tercsid hte veor iknaltg headr eb nac resrctchaa eth but nees be cna nscee on etidcsr teraf begin cetsidr eth adn aclbk to fseda oiemv teh kite bxo het hguthor ifsle he eehrw emivo the fo gbiennngi eth eran cnees hte treereasc brrya fifceo ttah fo uto egt to iygnd swa i me adn uoy eebntwe ybrra is eusr  ocjk npelol fyl ot ady ubteialfu  rbary go lal it tle  dayn edn remihngat hits lliw henw  enk eyknn og it tel nayd leif ym vgiinl si bee ahtt kne sohp easanssv in enhoy bdeoveaprep hte eses adn swdkiela het no yb askwl nek byarr yuo hantk snaevas ylf to meti ist cjoks lasbmrce rihtg lla ybrra xten owsh phle i anc raryb aeevrflsi a euryo asvnaes em to ti aeevl just ienvna mlbrope no brary wanyehre mhte egt cant i adn reord iltup huge itsh tog usjt i yrrab  otnfoenra gaert a aevh nsveaas creefsaib a swa eedden i all riatspea cdokoingsbul a aydlrea swa i aamm oldemobsoo oto ayrewl a hse ocw late im syrro deobolosom uyo lhep lilw caaosties ioqmtosu my me seuxec uyo ludow bryar momten a otg uoy eahv yrors mi rrbay avenass deai on adh i ryarb tmea of ceiep a leki eelf utjs i eomtsisem  lnekci a ese ondt i and em lal sti hecees mreac kiml wco cwo a twih nltgkai etrnlrcuy si eh amilasn etohr orf rowk alegl seod aybrr ewehr ophs het in rmoo a is eehtr eeths torfge tond roebaepdvpe si it tath itwh yeohn moes leki you oudwl  xent hswo leph i anc roefnoant gtrae a haev ecnahg oury hsree srcumoet ot savaesn oshp aesassnv ta iaehmwnle gnnnrui adn pu cbak rea ceftiroas nhyeo eeb het gtintoh elat inrogkw be llwe ngiefel a ogt i  ietm teh nows acll a eakm to denes aonyybd if aht nmklera hsi no tiugntp aamd abkc era eebs hte mmo rpka in oby prak terclna to adhes neht dna hsop ssasenva in fesrowl eth elapnoislt yrrba  cny ovre lingyf are skojc pelnol the dan imte ni rwofdra alhsf lapne het no frsewol teh mrof ollnep teg jokcs elnlop hte and ayrbr rabyr uro thats janet haye oh ti satcech ybarr ugn ccencntlgarotile a rabyr twohr ocjks enllop hte slevees hte rea od ttoag i lal fit eftrpce a sti nda ockj openll a im  yahe aryrb this dnraee yovue  eher bryar no lohd 1 jcok lelpon ekyahinc epxtec me fowoll nhet aybrr nhaikecy aihycnkse islek owh eeb eseb wree ebse acnsikyhe thyoris auatrln fo smeuum tujs ro ebes eb ot going ew era  sya uoy do hawt emtnom oru is ihts eispecs a as euivsrv gnano erwe fi  hits liek sdser dna owrslef aepoilntl noehy amek hwo sone nlyo hte eewr  nechca atls oru is this nesma thta  ehatr on nhywaere ilblaeaav rleoswf lsat hte frmo  oenlpl lsat eht tiwh erecodv si nuwary stih  eveenroy nlesit  ety oend otn reew but  rybar uyo tnakh  aadm ngiuse was hatt relwfo teh aws i ruecso fo rehwe lfeorw ngtia waht abrry rlwofe anitg eht see uoy idd rkdowe ti abyrr dmaa rghit  sneasva gvhiefih on rybar givfhhei ot tuboa si ssaevna esy  yarrb fyl ot ohw em auhtgt you it ddi ew yrabr snvaaes lnasd lfeays nealp teh and attecrs eseb het elrdaya no eocm  nwoma in ti rdop in ti odrp wno  cnteer the orf aim  it of atrp a be it dopr jsut  sverree ullf ti mlesl arafid eb tndo theer in snoe oyru egt abryr wbereofel teh ovre gisninnp nda nogrivhe ntralysiialcule is epnla eht rpnttea teskienilc na ni lfgniy leapn hsit is or kcoaokhookoo i am ubd yfl to how wokn i ywa yoln hte hstsi  abrry rryab sianne si hist  nesavas it ndarou tertoa  up atli wnod osne dowfarr lupl  feolerbwe het voer eohvsr nepla hte ebse of olimslni fo eadm wleofr tisanplug ntgai teh nmea i rhtis edoewlrf a in ygu fat a tasht yarrb lferwo het at mingai mi  vesnasa laepn the of tipreuc a teak to tsier and uot arsekf eh tirhs rwfoeled a in ygu fat a ta oepidtn onw si anpel hte owrelf ttha  rryba oen chwih  svnseaa oen ehort eht folrew tath ont  pnela yabrne a no inadpet oewrlf a at odpteni is oens laspen hte ruoand it spni  resveer llfu eayrd  elfwor thta no adln  it tatsh wno yeas good odgo aryrb fvrtifmeiaa dvua ul ulo boys rdyae oepwr bee no in ggoin wree engines teh otu baryr ko  assnaev efolrw the for ima aensvsa  rrayb bee ntkiighn bee nhkginti bee tinhnkig ebse omoitnfar oflwre sgtnaplui tgnai a iton eodgrazni are seeb eht all ahtt rleveade si ti taht on htgils esmo etg  dub aramtc the no si lorwd eth in hwta  rtaprooe worte ctnoolr ebe gnihntki eeb ihnintgk eeb nnkihgit ebse nwdo seon eth bngri  institcn 2nmoalioye7rdlil a ilke  em iupgnll gotrns tsi nokw ontd i  ryabr atwh  ssavean isgoemnht gfeeinl im tnhki i unmeti a twia rrbya bee nihgtnki bee kgnhinit bee kntighin eesb cbsak terih on ganlyi ebes fo iolnlmsi are hetre yunrwa het no eeb khintign  eeb kinithng  baryr ryarb bee tinkh ot otg uyo no cemo  udycol all ist gnthnio on svesana oyu nac tghiynan see ntac i where rryba koptblac het on acn itn itsh dorp tsel thigr lal vaud ul ulo eholl  ksjco nploel yoewll and bcakl  duav ul ulo elwofl a hbedni egt do hyte  scjok pnloel het aryrb nalpe het cgrainyr aer skojc olnelp eht of all rehte in nacscooi appyh a fro lesofrw ayn tog ebnosn npeho ghhruot davu lu lou lehlo arrby up cpski ryarb ehpno a keli gnisr eaaentnn raybrs knwo dont i anavses nigfly lfeasy won is enpla het gfnily enpal het is ohw naevssa trun ym its no eocm wyh  rbyra it lohd  snsvaae it of uot apns uoy  raryb it fo out naps ouy  sneasav ti of tuo sanp you  arryb ti of uot span uyo  esasvna nepla eth dneur nflgiy ear ksojc lnlpeo het lla htta see we ti fo tuo nasp ouy  ayrrb it fo out snpa uoy  nsasaev it of tuo sapn you  nsevasa pssal brray ti fo out npsa uoy ybrra ssalp asnavse ti of tou span ot vahe oyu tghteeor lursyofe lupl avssnae yrrab avnsaes ssalp ayrbr stih od ntac i aaesnvs gnpckniia im eont a ton ist aryrb coiev ryou in eotn ckyianp tath ithw rtoneetcnca to dahr evyr sit vsasnea tobluer fo otl a in were illngye nto im rbray elyl to ehav tndo avnssae face ensassav of nfrto ni sfly and ralaienp an leik rmsa shi uot sisktc arbyr pealn eht fo iwsng the ihtw em cpoy you do id awth do i if si hcance yoln rou raybr elapn eht ni yabrr dan nsavesa to cakb ihcstwse csene het uto evom  otu ti mvoe wlfleo htis nehidb egt lets yuo fo all vuda ul ulo anpel the ortsawd giyfnl bese rtheo miellptu twih nolga skcjo leponl hte nad aduv lu ulo ees ew utb slpmutme lenap het epnal a lfy tncano i tuo rstnu it os nvassae not rewe onw dna  rrbay me henglpi eben have aym thta  avsnase time elwho het loptiaotu on wree we nkhit i atwi arbry eaphepnd wtah ryabr ffo sunrt tituoopal adn anepl the sith btol ggtinhlin a eeebppeb peeepbeb nrho eth nhko ot tipegnerdn rdah so nsit thsi navsesa ovehr efgtor  rbary rvhoe  snvasea vhroe dnwo trhgi etlf rrbay yfl ot who snevsaa ehicngat si brary dna tisweshc nesec hte elhol  bsee oleylw nad clbka   oewfll a dbeihn gte we  lljoe of mead ont ewre wya eeb eth httsa  rgheoett niokrgw to abkc sebe gte to nwta i why shtta  eeeyrnvo ot su to lezedira ew thna meor  reffidceen gib a kasme ti ewll it od yuo if  ojb mllas a obuta uyo lelt em elt ubt  bosj lalms of tol a ondig eebs fo tlo a atesk nyheo ankigm  uyo to msetryy a be amy wkor we ayw hte vt no iardo hhtgour yrbar levi ggion erwe  wrce snew bee yb nsatd  erwc nwes eeb it ogt  eeb iar eht on htis etg  ubbeml bob snese no akem sasm bdoy and ngwsi the fo eara aceursf eth  stiem mloiiln a ihts ahred we anhvte idrao ohgtuhr aryrb slmal too are gwnsi ehirt  lal ta lfy ot ebal eb dsohultn bee a ncchliytale ubd peoh oyln uroy he stin ubt rreeotpr adegam heugno deon hvtyee  pdrsmecoa cconoutna shi nda bonnes mr tihw filmraai equit mi dub elapn ttah no eeb a treehs tenimu a jsut lmbbeu bob eepenicrxe flhgit on ylsaeoublt thiw  rtolonsc het at adivuilnsdi tow and eara eht ni tmosr a veah we lmebub obb hwti iknglta erporrte sewn nmhau the to sscwehit eesnc het slfrweo daam nad rac cleun timnar najet cwer tfhigl adictnacietpa na and  wrefols eplope hitw doeald nlepa a dlan ot atpintgetm si umbbel bbo yrbra ahstt aamd cryivto laelg ihs mfro hfser ennbos ybrar  ogdnepilev is ceens sfuesesunpl a eewhr  rpoitra kfj romf news eitraabeklng meos haev ew luembb obb is tihs mubble obb wnse bee teh acgwhtin wno era we apnel eth of orfnt ni mlsoo morts nnglithgi omoinsu na nginghlti osme noti ehedda eewr rarby atiw avasnes ionwdw hte edotusi csludo hilggnint see ew tub tib etllti a fro esilf and odwn ssti nassvea be it odclu radh who abryr sye  eavassn tlipo a oavttarl ojhn isnt otn ywh  ryrab apeln a fyl atnc i vaanses eiengns gehu wisgn giatn tog sit  eeb maelt big a hnat mero oitngnh si sith nevsaas brray gtrea ho altir oyehn eth morf dbu nneosb ryrab  yrrab that whso  bdu is ereht caft fo amrtte a sa rybra nreeexpeci ihgtfl veah rndoaob naoeyn esod odog ont dub loiotpc the si so and onscunuscoi esh nsaaves otlpi teh ewhers bud rkyo wne rfmo ritflos a mi oloemb ensaasv si hsti aanevss satsut ryou wtash 635 hilfgt etowr ornctol jfk is hsti lenpa on iardo tuhghor cahetdwtri dbu enlpa eth gilfyn eosn no  on  rbary joke bee aonrteh ttah si seavnas uiosnscunoc bhot rehtye nda tboa a in osen albd onse now  plddxeeo tafr ifel a tpueoe a ubdrutsets a wsa ehrte htne tub them ot alkt ot dreti i ybrar eher eedpphan twah saasenv lpsito sonounuccsiu hte dan tfar life eth sese dna orod hte nopse anvesas yuhrr peseal nda cnatec amrlno cudnfeso skloo savaesn topikcc hte ot rtrope eaples b24 in boomle eaasvns smsi a wdluo  tcnaaip ryou si shti saeerpssgn anteonofr ogdo ccneat otnehurs a hiwt rcmnieot no abyrr byrar oh lshfiem ot rybra nucoincssuuo htbo ear heyt rfool teh to lflsa dna out nekkcod sget ohw ocstt noti oabt aflneaailtb na uealnhcs hwich ubtnto arft feil eth no asfll eh and uto dknoeck si ahl abrry thi to tmeaptt an in vuamuc the iwht fcea hte in alh stih octst ovme notd scott pacniat oeyanttr na hswo  dahe ihs no is brray kwon neodts hal lah toaterny an mi meunit a atiw  yrbra houh
");


let sigma = prompt("sigma")*0.6;


player.move = function() {
	if (player.deathTimer) return;
	let p = player.rect;

	let accX = 3*(controls.forward - controls.backward);
	player.velX += accX;
	if (Math.sign(accX))
		player.dir = accX < 0 ? 'l' : 'r';
	player.velX *= 0.7;
	p.pos.x += Math.round(player.velX)/(1 + p.isInsideGrp(map.simBSequence, 7));
	if (p.fixPos(player.velX, "x")) player.velX = 0;
	for (let i in map.blocks) {
		let b = map.blocks[i];
		b.meta.prevPos = {...b.pos};
	}
	moveBlocksX();
	moveBlocksX();
	if (map.isCollMap(p, map.death)) player.tmpDead = 'x';

	let ySign = Math.sign(player.velY);
	let canJump = false;
	let isCollMap = false;
	for (let i = 0; i < Math.floor(player.velY*ySign/10); i++) {
		p.pos.y += 10*ySign/(1 + p.isInsideGrp(map.simBSequence, 7));
		if (p.fixPos(player.velY, "y")) {
			canJump = gravity()*player.velY >= 0 || canJump;
			player.velY = 0;
			isCollMap = true;
		}
	}
	let left = player.velY%10;
	p.pos.y += Math.round(left)/(1+p.isInsideGrp(map.simBSequence, 7));
	if (p.fixPos(player.velY, "y")) {
		canJump = gravity()*player.velY >= 0 || canJump;
		player.velY = 0;
		isCollMap = true;
	}
	player.collWBlock = false;
	moveBlocksY(isCollMap);
	if (map.isCollMap(p, map.death) && !player.tmpDead) player.tmpDead = 'y';
	if (!map.isCollMap(p, map.death)) player.tmpDead = false;
	if (player.modifiers.jump) {
		let distFromPast = Infinity;
		for (let i in map.simPSequence) {
			distFromPast = Math.min(distFromPast, p.dist(map.simPSequence[i]));
		}
		modifiers.jump.active = distFromPast < 90;
	} else {
		modifiers.jump.active = false;
	}

	let isInside = p.isInsideGrp(map.simBSequence, 7);
	if (!isInside) {
		player.velY += gravity();
		if (controls.jump && canJump) {
			player.velY = jumpheight();
		} else if (controls.jump && player.collWBlock) {
			player.velY = jumpheight();
		}
		player.velY *= 0.99;
		c.style.filter = "invert(0)";
	} else {
		player.velY = 5*(controls.down - controls.jump);

		let velX = 5*(controls.forward - controls.backward);
		player.velX = velX;
		if (Math.sign(velX))
			player.dir = velX < 0 ? 'l' : 'r';

		c.style.filter = "invert(1)";
	}
	if (Math.abs(p.pos.y) > 5000) {
		player.deathTimer = 10;
	}
	if (player.tmpDead) {
		player.deathTimer = 10;
		p.fixPos(player.tmpDead == 'x' ? player.velX : player.velY, player.tmpDead, map.death);
		map.deathBody();
		camera.pos.x = p.pos.x + 15;
		camera.pos.y = Math.max(Math.min(p.pos.y + 15, 3500), -3500)
		player.tmpDead = false;
	}

	logBlocksPos();

	if (map.sequenceTCounter == 0 && player.sequence.length < 1e5 && map.sequenceLimit > 0)
		player.sequence.push({...p.pos});

	camera.pos.x = player.rect.pos.x + 15;
	camera.pos.y = Math.max(Math.min(player.rect.pos.y + 15, 3500), -3500);
}

function gravity() {

	let base = sigma;
	base *= player.modifiers.gravity * 0.5 + 1;
	return base;
}
function jumpheight() {
	let base = -15*Math.sign(gravity());
	base *= Math.sqrt(player.modifiers.jump*modifiers.jump.active)*0.4 + 1;
	return base;
}


function moveBlocksX() {
	let p = player.rect;

	let prevVelX = player.velX;
	
	for (let i in map.blocks) {
		let b = map.blocks[i];
		let isColl = map.isCollMap(b, map.map.concat(map.bodies).concat(map.death));

		if (isColl) {
			b.fixPos(player.velX, "x", map.map.concat(map.bodies).concat(map.death));
		}

		if (p.isColliding(b)) {
			b.meta.logPos = true;
			let iter = 0;
			let xSign = Math.sign(prevVelX);

			if (isColl) {
				if (xSign == 1) p.pos.x = b.pos.x - p.width;
				else p.pos.x = b.pos.x + b.width;
				player.velX = 0;
				continue;
			}
			let tmpXSign = xSign;
			while (p.isColliding(b) && iter < Math.abs(prevVelX) + 40) {
				iter++;
				if (xSign == 0) tmpXSign = iter*((iter%2)*2-1)
				b.pos.x += tmpXSign/2;
				p.pos.x -= tmpXSign/2;
			}
			if (iter > 0) {
				player.velX *= 0.8;
			}
		}
	}
}

function moveBlocksY(isCollMap) {
	let p = player.rect;

	let prevVelY = player.velY;
	
	for (let i in map.blocks) {
		let b = map.blocks[i];
		b.pos.y += Math.round(b.meta.velY);
		let bprevVelY = b.meta.velY;
		let isColl = map.isCollMap(b, map.map.concat(map.bodies).concat(map.death));

		if (isColl) {
			if (b.fixPos(b.meta.velY, "y", map.map.concat(map.bodies).concat(map.death))) {
				b.meta.velY = Math.sign(b.meta.velY)*1e-16;
			}
		}

		if (p.isColliding(b)) {
			b.meta.logPos = true;
			let iter = 0;
			let ySign = Math.sign(prevVelY);
			if (ySign != -1) {
				player.collWBlock = true;
			}

			if (isColl) {
				if (p.isColliding(b)) {
					if (ySign == 0) return;
					if (ySign == 1) p.pos.y = b.pos.y - p.height;
					else p.pos.y = b.pos.y + b.height;
					player.velY = 0;
					continue;
				}
			}
			if (isCollMap) {
				if (b.isColliding(p)) {
					let ySign = Math.sign(b.meta.velY)
					if (ySign == 1) b.pos.y = p.pos.y - b.height;
					else b.pos.y = p.pos.y + p.height;
					b.meta.velY = 0;
					continue;
				}
			}
			while (p.isColliding(b) && iter < Math.abs(prevVelY)*2) {
				iter++;
				b.pos.y += ySign/2;
				if (map.isCollMap(b, map.map.concat(map.bodies).concat(map.death))) b.pos.y -= ySign/2;
				p.pos.y -= ySign/2;
			}
		}

		b.meta.velY += 0.6;
		b.meta.velY *= 0.99;
	}
}


function logBlocksPos() {
	if (map.sequenceLimit == 0) return;
	for (let i in map.blocks) {
		let b = map.blocks[i];
		if (!b.meta.logPos) continue;
		b.meta.sequence.s.push({pos: {...b.pos}, prevPos: {...b.meta.prevPos}});
	}
}

function fixBSPosX() {
	let p = player.rect;
	for (let i in map.simBSequence) {
		let b = map.simBSequence[i];
		if (!b.meta.collide || !p.isColliding(b)) continue;
		let prevPos = {...p.pos};
		p.fixPos(player.velX - (b.pos.x - b.meta.prevPos.x), 'x', b);
		if (map.isCollMap(p, map.map.concat(map.bodies).concat(map.simBSequence))) {
			p.pos = {...prevPos};
			b.meta.collide = false;
			for (let i in map.simBSequence) {
				let b1 = map.simBSequence[i];
				if (b1 == b && !b1.isColliding(p)) continue;
				b1.meta.collide = false;
			}
			continue;
		} else {
			player.velX = b.pos.x - b.meta.prevPos.x;
		}
	}
}
function fixBSPosY() {
	let p = player.rect;
	let isColl = false;
	for (let i in map.simBSequence) {
		let b = map.simBSequence[i];
		if (!b.meta.collide || !p.isColliding(b)) continue;
		isColl = true;
		let prevPos = {...p.pos};
		p.fixPos(player.velY - (b.pos.y - b.meta.prevPos.y), 'y', b);
		if (map.isCollMap(p, map.map.concat(map.bodies).concat(map.simBSequence))) {
			p.pos = {...prevPos};
			b.meta.collide = false;
			for (let i in map.simBSequence) {
				let b1 = map.simBSequence[i];
				if (b1 == b && !b1.isColliding(p)) continue;
				b1.meta.collide = false;
			}
			continue;
		} else {
			player.velY = b.pos.y - b.meta.prevPos.y;
		}
	}
	return isColl;
}
